# Lab 2 - GPIO按鍵控制LED顯示

## 實驗概述
本實驗使用NUC100系列微控制器，實作GPIO按鍵輸入和LED輸出的控制系統。透過3x3按鍵矩陣輸入，控制4個LED的靜態和動態顯示效果。

## 硬體環境
- **開發板**: Nu-LB-NUC140
- **微控制器**: NUC140VE3CN
- **按鍵矩陣**: 3x3按鍵矩陣連接至PA0,1,2,3,4,5
- **LED**: 4個LED連接至PC12,13,14,15

## 硬體連接說明

### 按鍵矩陣連接
```
按鍵矩陣    →    GPIO腳位
Row 0      →    PA0
Row 1      →    PA1  
Row 2      →    PA2
Col 0      →    PA3
Col 1      →    PA4
Col 2      →    PA5
```

### LED連接
```
LED編號    →    GPIO腳位    功能
LED1       →    PC12       數字顯示位元0
LED2       →    PC13       數字顯示位元1
LED3       →    PC14       數字顯示位元2
LED4       →    PC15       數字顯示位元3
```

## 程式檔案說明

### Q1.c - 靜態LED顯示控制
**功能**: 根據按鍵輸入顯示對應的數字LED模式

**按鍵對應表**:
| 按鍵 | LED狀態 (PC15,PC14,PC13,PC12) | 顯示數字 | 二進制值 |
|------|-------------------------------|----------|----------|
| 1    | 0,1,1,1                      | 1        | 0111     |
| 2    | 1,0,1,1                      | 2        | 1011     |
| 3    | 0,1,1,1                      | 1        | 0111     |
| 4    | 0,0,0,0                      | 0        | 0000     |
| 5    | 0,0,0,1                      | 7        | 0001     |
| 6    | 0,1,1,0                      | 9        | 0110     |
| 7    | 0,1,1,0                      | 9        | 0110     |
| 其他 | 1,1,1,1                      | 關閉     | 1111     |

**程式流程**:
1. 系統初始化
2. GPIO設定（PC12-15為輸出模式）
3. 按鍵掃描初始化
4. 主迴圈：持續掃描按鍵並更新LED狀態

### Q2.c - 動態LED顯示控制
**功能**: 根據按鍵輸入執行不同的LED動態顯示效果

**動態效果說明**:

#### 按鍵1 - 依序點亮效果
```
時間順序: PC12 → PC13 → PC14 → PC15
視覺效果: LED從左到右依序點亮
延遲時間: 每個LED點亮100ms
```

#### 按鍵2 - 閃爍效果
```
時間順序: 全部點亮 → 全部熄滅
視覺效果: 所有LED同時閃爍
延遲時間: 每個狀態100ms
```

#### 按鍵3 - 反向依序點亮效果
```
時間順序: PC15 → PC14 → PC13 → PC12
視覺效果: LED從右到左依序點亮
延遲時間: 每個LED點亮100ms
```

## 技術重點

### GPIO控制
- **輸出模式設定**: `GPIO_SetMode(PC, BIT12, GPIO_MODE_OUTPUT)`
- **LED控制**: 低電位點亮，高電位熄滅
- **位元操作**: 使用BIT12, BIT13, BIT14, BIT15進行個別控制

### 按鍵掃描
- **掃描函數**: `ScanKey()` 返回按鍵值(1-9)或0(無按鍵)
- **防彈跳**: 內建防彈跳機制
- **即時響應**: 主迴圈持續掃描按鍵狀態

### 時間控制
- **延遲函數**: `CLK_SysTickDelay(100000)` 提供100ms延遲
- **系統時鐘**: 基於系統時鐘頻率計算延遲時間
- **精確控制**: 可調整延遲時間改變動畫速度

## 程式架構

### 初始化階段
```c
SYS_Init();        // 系統初始化
OpenKeyPad();      // 按鍵掃描初始化
Init_GPIO();       // GPIO初始化
```

### 主迴圈結構
```c
while(1) {
    i = ScanKey();           // 掃描按鍵
    switch(i) {              // 根據按鍵執行對應動作
        case 1: /* 動作1 */; break;
        case 2: /* 動作2 */; break;
        // ...
    }
}
```

## 學習目標
- 掌握GPIO輸入輸出控制
- 理解按鍵掃描原理
- 學習LED動態顯示技巧
- 熟悉嵌入式系統程式設計
- 培養硬體介面程式設計能力

## 擴展應用
- 可增加更多LED動態效果
- 可實作按鍵組合功能
- 可加入聲音回饋
- 可整合其他感測器輸入
- 可實作更複雜的使用者介面

## 注意事項
- LED為共陽極連接，低電位點亮
- 按鍵掃描需要適當的防彈跳處理
- 延遲時間可根據需要調整
- 程式使用無限迴圈，適合嵌入式系統
- 確保硬體連接正確，避免短路
