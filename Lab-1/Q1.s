; ================================================================
; Lab 1 - Question 1: 計算陣列元素平方和
; 功能：計算陣列中所有元素的平方和
; 硬體：ARM Cortex-M0 微處理器
; 作者：damnm3@googlegroups.com 共同作者
; ================================================================

        AREA    |.text|, CODE, READONLY    ; 定義程式碼區域，唯讀
        THUMB                               ; 使用Thumb指令集
        EXPORT  __main                      ; 匯出主程式入口點
        EXPORT  main                        ; 匯出main函數
        ENTRY                               ; 標記程式進入點

__main
main
        ; ================================================================
        ; 初始化階段
        ; ================================================================
        LDR     r0, =array                  ; r0 = 陣列起始位址
        MOVS    r1, #10                     ; r1 = 陣列元素個數 (10個)
        MOVS    r3, #0                      ; r3 = 累加器，初始值為0

        ; ================================================================
        ; 主迴圈：計算平方和
        ; ================================================================
loop
        LDR     r2, [r0]                    ; r2 = 載入當前陣列元素值
        ADDS    r0, #4                      ; r0 = 移動到下一個陣列元素 (4位元組)
        MULS    r2, r2                      ; r2 = r2 * r2 (計算平方)
        ADDS    r3, r2                      ; r3 = r3 + r2 (累加平方值)
        SUBS    r1, #1                      ; r1 = r1 - 1 (計數器減1)
        BNE     loop                         ; 如果r1 != 0，繼續迴圈

        ; ================================================================
        ; 結果處理
        ; ================================================================
        MOV     r4, r3                      ; r4 = 最終結果 (平方和)

        ; ================================================================
        ; 程式結束
        ; ================================================================
stop    B       stop                        ; 無限迴圈，程式停止

        ; ================================================================
        ; 資料區域
        ; ================================================================
        AREA    myData, DATA, READONLY      ; 定義資料區域，唯讀
        ALIGN                                ; 對齊記憶體邊界
array   DCD     2, 4, 7, 3, 1, 2, 10, 11, 5, 13  ; 定義10個整數陣列
        END                                  ; 程式結束
