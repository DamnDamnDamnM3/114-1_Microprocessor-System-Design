# Lab 3 - 蜂鳴器與七段顯示器控制

## 實驗概述
本實驗使用NUC100系列微控制器，實作蜂鳴器音效控制和七段顯示器文字滾動顯示。結合按鍵輸入、音效輸出和視覺顯示，建立一個互動式使用者介面系統。

## 硬體環境
- **微控制器**: NUC100系列
- **按鍵矩陣**: 3x3按鍵矩陣連接至PA0,1,2,3,4,5
- **蜂鳴器**: 連接至PB11
- **LED**: 4個LED連接至PC12,13,14,15
- **七段顯示器**: 4位七段顯示器連接至PC4,5,6,7(位選)和PE0-7(段選)

## 硬體連接說明

### 按鍵矩陣連接
```
按鍵矩陣    →    GPIO腳位
Row 0      →    PA0
Row 1      →    PA1  
Row 2      →    PA2
Col 0      →    PA3
Col 1      →    PA4
Col 2      →    PA5
```

### 蜂鳴器連接
```
蜂鳴器      →    GPIO腳位
控制腳      →    PB11
```

### LED連接
```
LED編號    →    GPIO腳位    功能
LED1       →    PC12       數字顯示位元0
LED2       →    PC13       數字顯示位元1
LED3       →    PC14       數字顯示位元2
LED4       →    PC15       數字顯示位元3
```

### 七段顯示器連接
```
七段顯示器  →    GPIO腳位    功能
位選1      →    PC4        第1個顯示器
位選2      →    PC5        第2個顯示器
位選3      →    PC6        第3個顯示器
位選4      →    PC7        第4個顯示器
段A        →    PE3        頂段
段B        →    PE4        右上段
段C        →    PE0        右下段
段D        →    PE5        底段
段E        →    PE6        左下段
段F        →    PE2        左上段
段G        →    PE7        中段
段DOT      →    PE1        小數點
```

## 程式檔案說明

### Q1.c - 按鍵控制蜂鳴器和LED顯示
**功能**: 按鍵按下時觸發蜂鳴器響聲並顯示對應的LED二進制模式

**按鍵對應表**:
| 按鍵 | 蜂鳴器響聲次數 | LED二進制顯示 | 顯示數字 |
|------|----------------|---------------|----------|
| 1    | 1次            | 0111          | 1        |
| 2    | 2次            | 1011          | 2        |
| 3    | 3次            | 0011          | 3        |
| 4    | 4次            | 1101          | 4        |
| 5    | 5次            | 0101          | 5        |
| 6    | 6次            | 1001          | 6        |
| 7    | 7次            | 0001          | 7        |
| 8    | 8次            | 1110          | 8        |
| 9    | 9次            | 0110          | 9        |

**程式流程**:
1. 系統初始化
2. GPIO設定（PB11蜂鳴器，PC12-15 LED）
3. 按鍵掃描初始化
4. 主迴圈：檢測按鍵按下和釋放
5. 按鍵釋放時執行對應動作

**按鍵檢測機制**:
- 使用狀態機避免重複觸發
- 檢測按鍵從按下到釋放的完整過程
- 確保每次按鍵只觸發一次動作

### Q2.c - 七段顯示器HOLA文字滾動控制
**功能**: 在七段顯示器上顯示滾動的HOLA文字，並使用按鍵控制滾動

**HOLA字元圖案**:
```
字元  二進制值  七段顯示
H     0x2A     ██  ██
O     0x82     ██████
L     0x9B     ██
A     0x22     ██  ██
```

**按鍵控制**:
| 按鍵 | 功能 | 說明 |
|------|------|------|
| 4    | 向右滾動 | HOLA → AHOL → LAHO → OLAH |
| 6    | 向左滾動 | HOLA → OLAH → LAHO → AHOL |
| 5    | 暫停滾動 | 停止自動滾動 |
| 8    | 重置 | 回到預設HOLA位置 |

**滾動效果**:
- 自動滾動：每秒移動一個位置
- 手動控制：按鍵立即改變滾動方向
- 多工顯示：使用時間分割顯示四個字元

## 技術重點

### 蜂鳴器控制
- **PWM控制**: 使用高低電位切換產生音頻
- **頻率控制**: 透過延遲時間控制音頻頻率
- **音量控制**: 透過響聲次數控制音量感知

### 七段顯示器控制
- **多工顯示**: 使用時間分割技術同時顯示多個字元
- **段控制**: 直接控制PE0-7腳位設定段狀態
- **位控制**: 使用PC4-7腳位選擇顯示器位置

### 按鍵處理
- **防彈跳**: 內建防彈跳機制
- **狀態檢測**: 檢測按鍵按下和釋放狀態
- **即時響應**: 主迴圈持續掃描按鍵狀態

### 時間控制
- **精確延遲**: 使用`CLK_SysTickDelay()`提供精確延遲
- **多工時序**: 控制七段顯示器的刷新頻率
- **動畫控制**: 控制滾動動畫的速度

## 程式架構

### 初始化階段
```c
SYS_Init();              // 系統初始化
OpenKeyPad();            // 按鍵掃描初始化
OpenSevenSegment();      // 七段顯示器初始化
GPIO_SetMode();          // GPIO設定
```

### 主迴圈結構
```c
while(1) {
    key = ScanKey();      // 掃描按鍵
    // 處理按鍵事件
    // 更新顯示
    // 控制音效
}
```

### 函數模組
- **Buzz()**: 蜂鳴器控制函數
- **Display_binary()**: LED二進制顯示函數
- **Display_7seg()**: 七段顯示器數字顯示函數
- **Segment_showPattern()**: 自定義圖案顯示函數

## 學習目標
- 掌握蜂鳴器音效控制技術
- 理解七段顯示器多工顯示原理
- 學習按鍵狀態檢測和處理
- 熟悉嵌入式系統時間控制
- 培養多媒體互動程式設計能力

## 擴展應用
- 可增加更多音效模式
- 可實作音樂播放功能
- 可增加更多文字滾動效果
- 可整合LCD顯示器
- 可實作遊戲互動功能

## 注意事項
- 蜂鳴器為無源蜂鳴器，需要PWM信號驅動
- 七段顯示器使用多工顯示，刷新頻率要適當
- 按鍵掃描需要適當的防彈跳處理
- 延遲時間可根據需要調整
- 確保硬體連接正確，避免短路
